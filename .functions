# Create a new directory and enter it
function mkd() {
	mkdir -p "$@" && cd "$_";
}

# Compare original and gzipped file size
function gz() {
	local origsize=$(wc -c < "$1");
	local gzipsize=$(gzip -c "$1" | wc -c);
	local ratio=$(echo "$gzipsize * 100 / $origsize" | bc -l);
	printf "orig: %d bytes\n" "$origsize";
	printf "gzip: %d bytes (%2.2f%%)\n" "$gzipsize" "$ratio";
}

# Run `dig` and display the most useful info
function digga() {
	dig +nocmd "$1" any +multiline +noall +answer;
}

golan() {
	local volumePath="$HOME/golan";

	if [[ -e "$volumePath" ]]; then
		diskutil unmount "$HOME/golan";
		rmdir "$HOME/golan";
	fi;

	mkdir "$volumePath" && \
	sshfs "$(whoami)@ssh.tu.c.bitbit.net:/nfs/home/$(whoami)" "$volumePath" -o volname=golan -o auto_cache -o reconnect -o defer_permissions -o noappledouble && \
	echo "Mounted"
}

# Retry command until success
retry() {
	until "$@";
	do
		sleep 1;
	done;
}
